import{a as H}from"./chunk-24XH2B6T.js";import{a as R}from"./chunk-5DZZGDDZ.js";import{$a as k,Aa as E,Bb as N,Cb as A,Da as p,Db as z,Eb as W,Fb as B,Gb as L,Hb as q,Jb as U,Ka as b,Kb as j,La as i,Lb as G,Ma as r,Na as f,Oa as x,Pa as _,Qa as s,Sa as l,Ta as g,Va as V,Wa as P,X as d,Xa as M,Y as u,Ya as C,Za as S,_a as O,a as h,b as v,pb as F,qb as I,ra as c,sb as D,tb as T,va as w}from"./chunk-CQMFC4HS.js";function K(a,t){if(a&1){let e=x();i(0,"button",4),_("click",function(){d(e);let n=s();return u(n.abrirFormularioNuevo())}),l(1,"\u2795 Agregar mueble"),r()}}function Q(a,t){a&1&&(i(0,"th"),l(1,"Acciones"),r())}function X(a,t){if(a&1&&(i(0,"li"),l(1),r()),a&2){let e=t.$implicit;c(),P(" ",e.cantidadUtilizada," ",e.material.unidadDeMedida," de ",e.material.nombre," ")}}function Y(a,t){if(a&1){let e=x();i(0,"td")(1,"button",4),_("click",function(){d(e);let n=s().$implicit,m=s(2);return u(m.editarMueble(n))}),l(2,"\u270F\uFE0F Editar"),r(),i(3,"button",4),_("click",function(){d(e);let n=s().$implicit,m=s(2);return u(m.eliminarMueble(n.id))}),l(4,"\u{1F5D1}\uFE0F Eliminar"),r()()}}function Z(a,t){if(a&1&&(i(0,"tr")(1,"td"),l(2),r(),i(3,"td"),l(4),r(),i(5,"td"),l(6),O(7,"currency"),r(),i(8,"td"),l(9),r(),i(10,"td")(11,"ul"),p(12,X,2,3,"li",5),r()(),p(13,Y,5,0,"td",3),r()),a&2){let e=t.$implicit,o=s(2);c(2),g(e.nombre),c(2),g(e.descripcion),c(2),g(k(7,6,e.precioVenta,"CLP")),c(3),g(e.stock),c(3),b("ngForOf",e.materialMuebles),c(),b("ngIf",o.esAdmin)}}function $(a,t){if(a&1&&(i(0,"table")(1,"thead")(2,"tr")(3,"th"),l(4,"Nombre"),r(),i(5,"th"),l(6,"Descripci\xF3n"),r(),i(7,"th"),l(8,"Precio"),r(),i(9,"th"),l(10,"Stock"),r(),i(11,"th"),l(12,"Materiales"),r(),p(13,Q,2,0,"th",3),r()(),i(14,"tbody"),p(15,Z,14,9,"tr",5),r()()),a&2){let e=s();c(13),b("ngIf",e.esAdmin),c(2),b("ngForOf",e.muebles)}}function ee(a,t){if(a&1){let e=x();i(0,"div")(1,"label"),l(2),i(3,"input",13),_("ngModelChange",function(n){let m=d(e).index,y=s(2);return u(y.actualizarMaterial(y.muebleSeleccionado.materialMuebles[m].material.id,n))}),r()()()}if(a&2){let e=t.$implicit,o=t.index,n=s(2);c(2),V(" ",e.nombre," (",e.unidadDeMedida,"): "),c(),b("ngModel",n.muebleSeleccionado.materialMuebles[o].cantidadUtilizada)}}function te(a,t){if(a&1){let e=x();i(0,"div")(1,"h3"),l(2),r(),i(3,"form",6),_("ngSubmit",function(){d(e);let n=s();return u(n.guardarMueble())}),i(4,"label"),l(5," Nombre: "),i(6,"input",7),S("ngModelChange",function(n){d(e);let m=s();return C(m.muebleSeleccionado.nombre,n)||(m.muebleSeleccionado.nombre=n),u(n)}),r()(),f(7,"br"),i(8,"label"),l(9," Descripci\xF3n: "),i(10,"input",8),S("ngModelChange",function(n){d(e);let m=s();return C(m.muebleSeleccionado.descripcion,n)||(m.muebleSeleccionado.descripcion=n),u(n)}),r()(),f(11,"br"),i(12,"label"),l(13," Precio Venta: "),i(14,"input",9),S("ngModelChange",function(n){d(e);let m=s();return C(m.muebleSeleccionado.precioVenta,n)||(m.muebleSeleccionado.precioVenta=n),u(n)}),r()(),f(15,"br"),i(16,"label"),l(17," Stock: "),i(18,"input",10),S("ngModelChange",function(n){d(e);let m=s();return C(m.muebleSeleccionado.stock,n)||(m.muebleSeleccionado.stock=n),u(n)}),r()(),f(19,"br"),i(20,"fieldset")(21,"legend"),l(22,"Materiales del mueble"),r(),p(23,ee,4,3,"div",5),r(),i(24,"button",11),l(25,"\u{1F4BE} Guardar"),r(),i(26,"button",12),_("click",function(){d(e);let n=s();return u(n.cancelarFormulario())}),l(27,"\u274C Cancelar"),r()()()}if(a&2){let e=s();c(2),g(e.muebleSeleccionado.id?"Editar Mueble":"Agregar Mueble"),c(4),M("ngModel",e.muebleSeleccionado.nombre),c(4),M("ngModel",e.muebleSeleccionado.descripcion),c(4),M("ngModel",e.muebleSeleccionado.precioVenta),c(4),M("ngModel",e.muebleSeleccionado.stock),c(5),b("ngForOf",e.materialesDisponibles)}}var J=class a{constructor(t,e,o){this.mueblesService=t;this.materialesService=e;this.authService=o}muebles=[];materialesDisponibles=[];muebleSeleccionado=null;mostrarFormulario=!1;esAdmin=!1;ngOnInit(){this.cargarMuebles(),this.cargarMateriales(),this.esAdmin=this.authService.isAdmin()}cargarMuebles(){this.mueblesService.obtenerMuebles().subscribe({next:t=>{console.log("Muebles recibidos:",t),this.muebles=t},error:t=>console.error("Error al obtener muebles",t)})}cargarMateriales(){this.materialesService.obtenerMateriales().subscribe({next:t=>{this.materialesDisponibles=t},error:t=>console.error("Error al cargar materiales",t)})}abrirFormularioNuevo(){this.muebleSeleccionado={nombre:"",descripcion:"",precioVenta:0,stock:0,materialMuebles:this.materialesDisponibles.filter(t=>t.id!==null&&t.id!==void 0).map(t=>({id:void 0,cantidadUtilizada:0,material:v(h({},t),{id:t.id})}))},this.mostrarFormulario=!0}editarMueble(t){this.muebleSeleccionado=v(h({},t),{materialMuebles:this.materialesDisponibles.filter(e=>e.id!==null&&e.id!==void 0).map(e=>{let o=t.materialMuebles.find(n=>n.material.id===e.id);return o||{id:void 0,cantidadUtilizada:0,material:v(h({},e),{id:e.id})}})}),this.mostrarFormulario=!0}actualizarMaterial(t,e){if(!this.muebleSeleccionado)return;let o=this.muebleSeleccionado.materialMuebles.find(n=>n.material.id===t);o&&(o.cantidadUtilizada=e)}guardarMueble(){this.muebleSeleccionado&&(this.muebleSeleccionado?.id?this.mueblesService.editarMueble(this.muebleSeleccionado).subscribe({next:()=>{this.cargarMuebles(),this.mostrarFormulario=!1,this.muebleSeleccionado=null},error:t=>console.error(t)}):this.mueblesService.agregarMueble(this.muebleSeleccionado).subscribe({next:()=>{this.cargarMuebles(),this.mostrarFormulario=!1,this.muebleSeleccionado=null},error:t=>console.error(t)}))}eliminarMueble(t){confirm("\xBFEst\xE1s seguro de eliminar este mueble?")&&this.mueblesService.eliminarMueble(t).subscribe({next:()=>this.cargarMuebles(),error:e=>console.error(e)})}cancelarFormulario(){this.mostrarFormulario=!1,this.muebleSeleccionado=null}static \u0275fac=function(e){return new(e||a)(w(H),w(R),w(G))};static \u0275cmp=E({type:a,selectors:[["app-muebles"]],decls:7,vars:3,consts:[[1,"navbar"],[1,"acciones"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],[4,"ngFor","ngForOf"],[3,"ngSubmit"],["type","text","name","nombre","required","",3,"ngModelChange","ngModel"],["type","text","name","descripcion","required","",3,"ngModelChange","ngModel"],["type","number","name","precioVenta","required","",3,"ngModelChange","ngModel"],["type","number","name","stock","required","",3,"ngModelChange","ngModel"],["type","submit"],["type","button",3,"click"],["type","number",3,"ngModelChange","ngModel"]],template:function(e,o){e&1&&(i(0,"nav",0)(1,"span"),l(2,"Lista Muebles"),r()(),i(3,"div",1),p(4,K,2,0,"button",2),r(),p(5,$,16,2,"table",3)(6,te,28,6,"div",3)),e&2&&(c(4),b("ngIf",o.esAdmin),c(),b("ngIf",o.muebles.length>0),c(),b("ngIf",o.mostrarFormulario&&o.muebleSeleccionado))},dependencies:[T,F,I,D,j,L,N,q,A,z,U,B,W],styles:["[_nghost-%COMP%]{display:block;background-color:#fdf6e3;padding:20px;font-family:Arial,sans-serif;font-size:18px;color:#333}.navbar[_ngcontent-%COMP%]{background-color:#8b5e3c;color:#fff;padding:15px 20px;font-size:22px;font-weight:700;border-radius:8px;margin-bottom:20px}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#a86f4c;color:#fff;border:none;padding:12px 20px;font-size:18px;border-radius:6px;cursor:pointer;margin-bottom:20px}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#935e3f}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]{background-color:wheat;color:#333;font-weight:700}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #ddd;padding:12px;text-align:left}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fff8ee}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#8b5e3c;color:#fff;border:none;padding:8px 12px;margin-right:5px;font-size:16px;border-radius:5px;cursor:pointer}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#6f442a}form[_ngcontent-%COMP%]{background-color:#fff4e6;padding:20px;border-radius:8px;max-width:600px;margin:20px auto;box-shadow:0 4px 8px #0000001a}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:15px;font-weight:700}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:10px;font-size:16px;margin-top:5px;border-radius:4px;border:1px solid #ccc}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px 18px;font-size:16px;border-radius:6px;margin-right:10px;cursor:pointer}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}"]})};export{J as MueblesComponent};
