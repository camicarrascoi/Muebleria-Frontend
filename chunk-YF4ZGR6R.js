import{a as L}from"./chunk-HQLIYGAP.js";import{Aa as y,Bb as I,Cb as k,Da as p,Db as V,Eb as T,Fb as N,Gb as D,Jb as A,Ka as m,Kb as W,La as e,Lb as z,Ma as t,Oa as S,Pa as f,Qa as s,Ra as x,Sa as a,Ta as u,X as _,Xa as b,Y as v,Ya as C,Za as P,a as E,pb as w,qb as O,ra as d,tb as F,va as h}from"./chunk-CQMFC4HS.js";function B(n,r){if(n&1){let o=S();e(0,"button",10),f("click",function(){_(o);let i=s();return v(i.abrirFormularioNuevo())}),a(1,"\u2795 Agregar proveedor"),t()}}function j(n,r){n&1&&(e(0,"th"),a(1,"Acciones"),t())}function G(n,r){if(n&1&&(e(0,"li"),a(1),t()),n&2){let o=r.$implicit;d(),u(o.nombre)}}function R(n,r){if(n&1){let o=S();e(0,"td")(1,"button",10),f("click",function(){_(o);let i=s().$implicit,l=s(2);return v(l.editarProveedor(i))}),a(2,"\u270F\uFE0F Editar"),t(),e(3,"button",10),f("click",function(){_(o);let i=s().$implicit,l=s(2);return v(l.eliminarProveedor(i.id))}),a(4,"\u{1F5D1}\uFE0F Eliminar"),t()()}}function U(n,r){if(n&1&&(e(0,"tr")(1,"td"),a(2),t(),e(3,"td"),a(4),t(),e(5,"td"),a(6),t(),e(7,"td"),a(8),t(),e(9,"td")(10,"ul"),p(11,G,2,1,"li",13),t()(),p(12,R,5,0,"td",12),t()),n&2){let o=r.$implicit,c=s(2);d(2),u(o.nombre),d(2),u(o.telefono),d(2),u(o.correo),d(2),u(o.direccion),d(3),m("ngForOf",o.materiales),d(),m("ngIf",c.esAdmin)}}function H(n,r){if(n&1&&(e(0,"table",11)(1,"thead")(2,"tr")(3,"th"),a(4,"Nombre"),t(),e(5,"th"),a(6,"Tel\xE9fono"),t(),e(7,"th"),a(8,"Correo"),t(),e(9,"th"),a(10,"Direcci\xF3n"),t(),e(11,"th"),a(12,"Materiales"),t(),p(13,j,2,0,"th",12),t()(),e(14,"tbody"),p(15,U,13,6,"tr",13),t()()),n&2){let o=s();d(13),m("ngIf",o.esAdmin),d(2),m("ngForOf",o.proveedores)}}function J(n,r){n&1&&(e(0,"div",23),a(1," El nombre es obligatorio. "),t())}function K(n,r){n&1&&(e(0,"div",23),a(1," El tel\xE9fono es obligatorio. "),t())}function Q(n,r){n&1&&(e(0,"div",23),a(1," El correo debe ser v\xE1lido. "),t())}function X(n,r){n&1&&(e(0,"div",23),a(1," La direcci\xF3n es obligatoria. "),t())}function Y(n,r){if(n&1){let o=S();e(0,"div",14)(1,"h3"),a(2),t(),e(3,"form",15,0),f("ngSubmit",function(){_(o);let i=s();return v(i.guardarProveedor())}),e(5,"label"),a(6," Nombre: "),e(7,"input",16,1),P("ngModelChange",function(i){_(o);let l=s();return C(l.proveedorSeleccionado.nombre,i)||(l.proveedorSeleccionado.nombre=i),v(i)}),t()(),p(9,J,2,0,"div",17),e(10,"label"),a(11," Tel\xE9fono: "),e(12,"input",18,2),P("ngModelChange",function(i){_(o);let l=s();return C(l.proveedorSeleccionado.telefono,i)||(l.proveedorSeleccionado.telefono=i),v(i)}),t()(),p(14,K,2,0,"div",17),e(15,"label"),a(16," Correo: "),e(17,"input",19,3),P("ngModelChange",function(i){_(o);let l=s();return C(l.proveedorSeleccionado.correo,i)||(l.proveedorSeleccionado.correo=i),v(i)}),t()(),p(19,Q,2,0,"div",17),e(20,"label"),a(21," Direcci\xF3n: "),e(22,"input",20,4),P("ngModelChange",function(i){_(o);let l=s();return C(l.proveedorSeleccionado.direccion,i)||(l.proveedorSeleccionado.direccion=i),v(i)}),t()(),p(24,X,2,0,"div",17),e(25,"button",21),a(26,"\u{1F4BE} Guardar"),t(),e(27,"button",22),f("click",function(){_(o);let i=s();return v(i.cancelarFormulario())}),a(28,"\u274C Cancelar"),t()()()}if(n&2){let o=x(4),c=x(8),i=x(13),l=x(18),M=x(23),g=s();d(2),u(g.proveedorSeleccionado!=null&&g.proveedorSeleccionado.id?"Editar Proveedor":"Agregar Proveedor"),d(5),b("ngModel",g.proveedorSeleccionado.nombre),d(2),m("ngIf",c.invalid&&c.touched),d(3),b("ngModel",g.proveedorSeleccionado.telefono),d(2),m("ngIf",i.invalid&&i.touched),d(3),b("ngModel",g.proveedorSeleccionado.correo),d(2),m("ngIf",l.invalid&&l.touched),d(3),b("ngModel",g.proveedorSeleccionado.direccion),d(2),m("ngIf",M.invalid&&M.touched),d(),m("disabled",o.invalid)}}var q=class n{constructor(r,o){this.proveedoresService=r;this.authService=o}proveedores=[];proveedorSeleccionado=null;mostrarFormulario=!1;esAdmin=!1;esUsuario=!1;ngOnInit(){this.cargarProveedores();let r=this.authService.getRole();this.esAdmin=r==="admin",this.esUsuario=r==="usuario"}cargarProveedores(){this.proveedoresService.obtenerProveedores().subscribe({next:r=>{console.log("Proveedores recibidos:",r),this.proveedores=r},error:r=>console.error("Error al obtener proveedores",r)})}abrirFormularioNuevo(){this.proveedorSeleccionado={nombre:"",rut:"",direccion:"",correo:"",telefono:"",materiales:[]},this.mostrarFormulario=!0}editarProveedor(r){this.proveedorSeleccionado=E({},r),this.mostrarFormulario=!0}guardarProveedor(){this.proveedorSeleccionado?.id?this.proveedoresService.editarProveedor(this.proveedorSeleccionado).subscribe({next:()=>{this.cargarProveedores(),this.mostrarFormulario=!1,this.proveedorSeleccionado=null},error:r=>console.error("Error al editar proveedor",r)}):this.proveedoresService.agregarProveedor(this.proveedorSeleccionado).subscribe({next:()=>{this.cargarProveedores(),this.mostrarFormulario=!1,this.proveedorSeleccionado=null},error:r=>console.error("Error al agregar proveedor",r)})}eliminarProveedor(r){confirm("\xBFEst\xE1s seguro de eliminar este proveedor?")&&this.proveedoresService.eliminarProveedor(r).subscribe({next:()=>this.cargarProveedores(),error:o=>console.error("Error al eliminar proveedor",o)})}cancelarFormulario(){this.mostrarFormulario=!1,this.proveedorSeleccionado=null}static \u0275fac=function(o){return new(o||n)(h(L),h(z))};static \u0275cmp=y({type:n,selectors:[["app-proveedores"]],decls:7,vars:3,consts:[["formProveedor","ngForm"],["nombre","ngModel"],["telefono","ngModel"],["correo","ngModel"],["direccion","ngModel"],[1,"navbar"],[1,"acciones"],[3,"click",4,"ngIf"],["border","1",4,"ngIf"],["class","formulario-proveedor",4,"ngIf"],[3,"click"],["border","1"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"formulario-proveedor"],["novalidate","",3,"ngSubmit"],["type","text","name","nombre","required","",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],["type","text","name","telefono","required","",3,"ngModelChange","ngModel"],["type","email","name","correo","required","",3,"ngModelChange","ngModel"],["type","text","name","direccion","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["type","button",3,"click"],[1,"error"]],template:function(o,c){o&1&&(e(0,"nav",5)(1,"span"),a(2,"Lista Proveedores"),t()(),e(3,"div",6),p(4,B,2,0,"button",7),t(),p(5,H,16,2,"table",8)(6,Y,29,10,"div",9)),o&2&&(d(4),m("ngIf",c.esAdmin),d(),m("ngIf",c.proveedores.length>0),d(),m("ngIf",c.mostrarFormulario))},dependencies:[F,w,O,W,D,I,k,V,A,N,T],styles:["[_nghost-%COMP%]{display:block;background-color:#fdf6e3;padding:20px;font-family:Arial,sans-serif;font-size:18px;color:#333}.navbar[_ngcontent-%COMP%]{background-color:#8b5e3c;color:#fff;padding:15px 20px;font-size:22px;font-weight:700;border-radius:8px;margin-bottom:20px}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#a86f4c;color:#fff;border:none;padding:12px 20px;font-size:18px;border-radius:6px;cursor:pointer;margin-bottom:20px}.acciones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#935e3f}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}thead[_ngcontent-%COMP%]{background-color:wheat;color:#333;font-weight:700}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #ddd;padding:12px;text-align:left}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fff8ee}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#8b5e3c;color:#fff;border:none;padding:8px 12px;margin-right:5px;font-size:16px;border-radius:5px;cursor:pointer}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#6f442a}ul[_ngcontent-%COMP%]{padding-left:20px;margin:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:disc}form[_ngcontent-%COMP%]{background-color:#fff4e6;padding:20px;border-radius:8px;max-width:600px;margin:20px auto;box-shadow:0 4px 8px #0000001a}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:15px;font-weight:700}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:10px;font-size:16px;margin-top:5px;border-radius:4px;border:1px solid #ccc}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px 18px;font-size:16px;border-radius:6px;margin-right:10px;cursor:pointer}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}.error[_ngcontent-%COMP%]{color:#d9534f;font-size:14px;margin-top:5px}.botones-formulario[_ngcontent-%COMP%]{margin-top:15px}"]})};export{q as ProveedoresComponent};
