<!-- Barra de navegaci√≥n simple -->
<nav class="navbar">
  <span>Lista Proveedores</span>
</nav>

  <!-- Bot√≥n Agregar solo visible para admin -->
  <div class="acciones">
    <button *ngIf="esAdmin" (click)="abrirFormularioNuevo()">‚ûï Agregar proveedor</button>
  </div>

  <!-- Tabla de proveedores -->
<table *ngIf="proveedores.length > 0" border="1">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Tel√©fono</th>
      <th>Correo</th>
      <th>Direcci√≥n</th>
      <th>Material</th>
      <th>Costo Unitario</th> <!-- Nueva columna -->
      <th *ngIf="esAdmin">Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let proveedor of proveedores">
      <td>{{ proveedor.nombre }}</td>
      <td>{{ proveedor.telefono }}</td>
      <td>{{ proveedor.correo }}</td>
      <td>{{ proveedor.direccion }}</td>

      <!-- Aqu√≠ hacemos un td que contiene un listado de materiales -->
      <td>
        <ul>
          <li *ngFor="let pm of proveedor.proveedorMateriales">
            {{ pm.material.nombre }}
          </li>
        </ul>
      </td>

      <!-- Aqu√≠ otro td con los costos unitarios, mismos orden que los materiales -->
      <td>
        <ul>
          <li *ngFor="let pm of proveedor.proveedorMateriales">
            {{ pm.costoUnitario }}
          </li>
        </ul>
      </td>

      <td *ngIf="esAdmin">
        <button (click)="editarProveedor(proveedor)">‚úèÔ∏è Editar</button>
        <button (click)="eliminarProveedor(proveedor.id!)">üóëÔ∏è Eliminar</button>
      </td>
    </tr>
  </tbody>
</table>

 <!-- Formulario para agregar/editar proveedores -->
<div *ngIf="mostrarFormulario" class="formulario-proveedor">
  <h3>{{ proveedorSeleccionado?.id ? 'Editar Proveedor' : 'Agregar Proveedor' }}</h3>
  <form (ngSubmit)="guardarProveedor()" #formProveedor="ngForm" novalidate>
    <!-- Campos b√°sicos -->
    <label>
      Nombre:
      <input
        type="text"
        [(ngModel)]="proveedorSeleccionado!.nombre"
        name="nombre"
        required
      />
    </label>
    <br />

    <label>
      Tel√©fono:
      <input
        type="text"
        [(ngModel)]="proveedorSeleccionado!.telefono"
        name="telefono"
        required
      />
    </label>
    <br />

    <label>
      Correo:
      <input
        type="email"
        [(ngModel)]="proveedorSeleccionado!.correo"
        name="correo"
        required
      />
    </label>
    <br />

    <label>
      Direcci√≥n:
      <input
        type="text"
        [(ngModel)]="proveedorSeleccionado!.direccion"
        name="direccion"
        required
      />
    </label>
    <br />

    <!-- Materiales y costos -->
    <div *ngIf="proveedorSeleccionado?.proveedorMateriales?.length">
      <h4>Materiales y Costos</h4>
      <div *ngFor="let pm of proveedorSeleccionado?.proveedorMateriales!; let i = index" style="margin-bottom:1em">
        <!-- ID del material (no editable, pero incluido en el objeto) -->
        <input
          type="hidden"
          [(ngModel)]="pm.material.id"
          name="materialId{{i}}"
        />

        <!-- Nombre (solo lectura) -->
        <label>
          Material:
          <input
            type="text"
            [value]="pm.material.nombre"
            readonly
          />
        </label>
        &nbsp;

        <!-- Costo -->
        <label>
          Costo Unitario:
          <input
            type="number"
            [(ngModel)]="pm.costoUnitario"
            [ngModelOptions]="{ standalone: true }"
            name="costoUnitario{{i}}"
            required
            min="0"
          />
        </label>
      </div>
    </div>

    <!-- Botones -->
    <button type="submit" [disabled]="formProveedor.invalid">üíæ Guardar</button>
    <button type="button" (click)="cancelarFormulario()">‚ùå Cancelar</button>
  </form>
</div>