<!-- Barra de navegaci√≥n simple -->
<nav class="navbar">
  <span>Lista Materiales</span>
</nav>

<!-- Bot√≥n Agregar solo visible para admin -->
<div class="acciones">
  <button *ngIf="esAdmin" (click)="abrirFormularioNuevo()">‚ûï Agregar material</button>
</div>

<!-- Tabla de materiales SIN overflow-x y adaptada al ancho -->
<div class="tabla-contenedor">
  <table *ngIf="materiales.length > 0" class="tabla-materiales">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Tipo</th>
        <th>Descripci√≥n</th>
        <th>Unidad de Medida</th>
        <th>Stock Actual</th>
        <th>Proveedores</th>
        <th>Muebles</th>
        <th *ngIf="esAdmin">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let material of materiales">
        <td>{{ material.nombre }}</td>
        <td>{{ material.tipo }}</td>
        <td>{{ material.descripcion }}</td>
        <td>{{ material.unidadDeMedida }}</td>
        <td>{{ material.stockActual }}</td>
        <td>
          <ul>
            <li *ngFor="let prov of material.proveedorMateriales">
              {{ prov.nombre }}
            </li>
          </ul>
        </td>
        <td>
          <ul>
            <li *ngFor="let mm of material.materialMuebles">
              {{ mm.muebleNombre }}: {{ mm.cantidadUtilizada }}
            </li>
          </ul>
        </td>
        <td *ngIf="esAdmin">
          <div class="acciones-botones">
            <button (click)="editarMaterial(material)">‚úèÔ∏è Editar</button>
            <button (click)="eliminarMaterial(material.id!)">üóëÔ∏è Eliminar</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Formulario para agregar/editar materiales -->
<div *ngIf="mostrarFormulario" class="formulario-material">
  <h3>{{ materialSeleccionado?.id ? 'Editar Material' : 'Agregar Material' }}</h3>
  <form #frm="ngForm" (ngSubmit)="guardarMaterial(frm)">
    <label>
      Nombre:
      <input
        type="text"
        name="nombre"
        required
        pattern="[A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√±√ë ]+"
        [(ngModel)]="materialSeleccionado!.nombre"
        (keypress)="soloLetras($event)"
        #nombre="ngModel"
      />
      <div class="error" *ngIf="nombre.invalid && nombre.touched">
        Solo letras y espacios.
      </div>
    </label>

    <label>
      Tipo:
      <select
        name="tipo"
        required
        [(ngModel)]="materialSeleccionado!.tipo"
      >
        <option *ngFor="let tipo of tiposMaterial" [value]="tipo">
          {{ tipo }}
        </option>
      </select>
    </label>

    <label>
      Descripci√≥n:
      <input
        type="text"
        name="descripcion"
        required
        pattern="[A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√±√ë ]+"
        [(ngModel)]="materialSeleccionado!.descripcion"
        (keypress)="soloLetras($event)"
        #descripcion="ngModel"
      />
      <div class="error" *ngIf="descripcion.invalid && descripcion.touched">
        Solo letras y espacios.
      </div>
    </label>

    <label>
      Unidad de Medida:
      <input
        type="text"
        name="unidadDeMedida"
        required
        [(ngModel)]="materialSeleccionado!.unidadDeMedida"
      />
    </label>

    <label>
      Stock Actual:
      <input
        type="number"
        name="stockActual"
        required
        min="0"
        step="1"
        [(ngModel)]="materialSeleccionado!.stockActual"
        (keypress)="soloNumeros($event)"
        #stockActual="ngModel"
      />
      <div class="error" *ngIf="stockActual.invalid && stockActual.touched">
        Solo n√∫meros enteros ‚â• 0.
      </div>
    </label>

    <!--
    <label>Proveedores:</label>
<div class="proveedores-lista">
  <label *ngFor="let proveedor of proveedores">
    <input
      type="checkbox"
      [value]="proveedor.id"
      (change)="toggleProveedorSeleccionado(proveedor, $event)"
      [checked]="isProveedorSeleccionado(proveedor.id!)"
    />
    {{ proveedor.nombre }}
  </label>
</div> -->

    <div class="botones-formulario">
      <button type="submit" [disabled]="frm.invalid">üíæ Guardar</button>
      <button type="button" (click)="cancelarFormulario()">‚ùå Cancelar</button>
    </div>
  </form>
</div>
