<!-- Barra de navegación simple -->
<nav class="navbar">
  <span>Lista Ventas</span>
</nav>

  <!-- Botón Agregar solo para admin -->
  <div class="acciones">
    <button *ngIf="esAdmin" (click)="abrirFormularioNuevo()">➕ Agregar venta</button>
  </div>

  <!-- Tabla de ventas -->
  <table *ngIf="ventas.length > 0" border="1">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Total</th>
        <th>Muebles Vendidos</th>
        <th *ngIf="esAdmin">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let venta of ventas">
        <td>{{ venta.fecha | date: 'dd/MM/yyyy' }}</td>
        <td>{{ venta.total | currency:'CLP':'symbol' }}</td>
        <td>
          <ul>
            <li *ngFor="let mueble of venta.ventaMuebles">
              {{ mueble.nombre }} (Cantidad: {{ mueble.cantidad }})
            </li>
          </ul>
        </td>
        <td *ngIf="esAdmin">
          <button (click)="editarVenta(venta)">✏️ Editar</button>
          <button (click)="eliminarVenta(venta.id!)">🗑️ Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Formulario para agregar/editar venta -->
  <div *ngIf="mostrarFormulario" class="formulario-venta">
    <h3>{{ ventaSeleccionada?.id ? 'Editar Venta' : 'Agregar Venta' }}</h3>
    <form (ngSubmit)="guardarVenta()" #formVenta="ngForm" novalidate>
      <label for="fecha">Fecha:</label>
      <input
        id="fecha"
        name="fecha"
        type="date"
        [(ngModel)]="ventaSeleccionada!.fecha"
        required
        #fecha="ngModel"
      />
      <div *ngIf="fecha.invalid && fecha.touched" class="error">
        La fecha es obligatoria.
      </div>

      <label for="total">Total (CLP):</label>
      <input
        id="total"
        name="total"
        type="number"
        [(ngModel)]="ventaSeleccionada!.total"
        required
        min="0"
        #total="ngModel"
      />
      <div *ngIf="total.invalid && total.touched" class="error">
        El total es obligatorio y debe ser positivo.
      </div>

      <label for="ventaMuebles">Muebles vendidos (IDs separados por coma):</label>
      <input
        id="ventaMuebles"
        name="ventaMuebles"
        type="text"
        [(ngModel)]="ventaMueblesSeleccionados"
        placeholder="1,3,5"
      />

      <div class="botones-formulario">
        <button type="submit" [disabled]="formVenta.invalid">Guardar</button>
        <button type="button" (click)="cancelarFormulario()">Cancelar</button>
      </div>
    </form>
  </div>